AntiFeatures:
  NonFreeNet:
    en-US: Depends on koofr.eu servers
Categories:
  - Cloud Storage & File Sync
  - File Encryption & Vault
  - System
License: MIT
AuthorEmail: support@koofr.net
AuthorWebSite: https://koofr.eu
WebSite: https://vault.koofr.net
SourceCode: https://github.com/koofr/vault
Changelog: https://github.com/koofr/vault/releases

AutoName: Koofr Vault

RepoType: git
Repo: https://github.com/koofr/vault.git

Builds:
  - versionName: 0.1.16
    versionCode: 116001
    commit: 07cd570ed3f749867397fa1267b19e03bfc0db7b
    subdir: vault-android/app
    sudo:
      - echo "deb https://deb.debian.org/debian bullseye main" > /etc/apt/sources.list.d/bullseye.list
      - apt-get update
      - apt-get install -y -t bullseye openjdk-11-jdk-headless
    gradle:
      - yes
    srclibs:
      - PhotoView@565505d5cb84f5977771b5d2ccb7726338e77224
      - rustup@1.27.0
    rm:
      - vault-android/app/libs/com/github/chrisbanes/PhotoView/565505d5cb/*ar
    scanignore:
      - vault-android/settings.gradle.kts
    build:
      - pushd $$PhotoView$$
      - export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64
      - sed -i "s/version = '2.3.0'/version = '565505d5cb'/" photoview/build.gradle
      - gradle publishToMavenLocal
      - popd
      - mv $$PhotoView$$/photoview/build/outputs/aar/photoview-release.aar libs/com/github/chrisbanes/PhotoView/565505d5cb/PhotoView-565505d5cb.aar
      - export GRADLE_CARGO_PROFILE=release
      - export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64
      - $$rustup$$/rustup-init.sh -y --default-toolchain 1.75.0 --target aarch64-linux-android
        armv7-linux-androideabi x86_64-linux-android i686-linux-android
      - source $HOME/.cargo/env
      - gradle generateUniFFIBindings
      - gradle cargoBuild
      - gradle bundleRelease
    ndk: 26.0.10792818

  - versionName: 0.1.20
    versionCode: 120001
    commit: b1473467d1808d3f6d0b02eafcd2f851e291d9ca
    subdir: vault-android/app
    gradle:
      - yes
    srclibs:
      - PhotoView@565505d5cb84f5977771b5d2ccb7726338e77224
      - rustup@1.27.0
    rm:
      - vault-android/app/libs
    prebuild:
      - sed '/sdk.dir/d' ../local.properties.example > ../local.properties
      - sed -i -e '/maven {/,+2d' -e '/repositories {/a mavenLocal()' ../settings.gradle.kts
      - sed -i -e 's/6.8/7.3.3/' $$PhotoView$$/gradle/wrapper/gradle-wrapper.properties
      - sed -i -e 's/4.1.2/7.2.2/' $$PhotoView$$/build.gradle
      - sed -i -e '/agp/s/8.12.2/8.11.1/' ../gradle/libs.versions.toml
    build:
      - pushd $$PhotoView$$
      - sed -i "s/version = '2.3.0'/version = '565505d5cb'/" photoview/build.gradle
      - gradle publishToMavenLocal
      - popd
      - export GRADLE_CARGO_PROFILE=release
      - export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64
      - $$rustup$$/rustup-init.sh -y --default-toolchain 1.89.0 --target aarch64-linux-android
        armv7-linux-androideabi x86_64-linux-android i686-linux-android
      - source $HOME/.cargo/env
      - gradle generateUniFFIBindings
      - gradle cargoBuild
      - gradle bundleRelease
    ndk: r28c

AutoUpdateMode: Version
UpdateCheckMode: Tags
CurrentVersion: 0.1.20
CurrentVersionCode: 120001
